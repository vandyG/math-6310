import{s as p}from"./chunk-DZLz74EQ.js";import{t as k}from"./react-BcIddLXZ.js";import{E as L,dt as T,ft as C,m as j,pt as x}from"./cells-B4cnsYe_.js";import{n as E,t as F}from"./jsx-runtime-DvsdsEjx.js";import{t as w}from"./cn-Dr9kMPPj.js";import{t as b}from"./events-BGfCi1Xy.js";import{r as H}from"./dist-CL0hPMY6.js";import{r as K}from"./useTheme-C5JyqXTm.js";import{t as M}from"./createLucideIcon-Be9UM2Pe.js";import{r as _}from"./input-Dm-m3XYB.js";import{t as D}from"./tooltip-BjoMzmCN.js";import{t as I}from"./useLifecycle-Bnvt0QrQ.js";import{r as z,t as A}from"./esm-BR7TuyMc.js";var O=M("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),P=p(E()),g=p(k()),h=p(F()),R=[H(),z({syntaxHighlighting:!0,highlightSpecialChars:!1,history:!1,drawSelection:!1,defaultKeymap:!1,historyKeymap:!1})];const B=(0,g.memo)(i=>{let e=(0,P.c)(8),{code:r,className:a}=i,{theme:s}=K(),o;e[0]===a?o=e[1]:(o=w(a,"text-muted-foreground flex flex-col overflow-hidden"),e[0]=a,e[1]=o);let l=s==="dark"?"dark":"light",t;e[2]!==r||e[3]!==l?(t=(0,h.jsx)(A,{minHeight:"10px",theme:l,height:"100%",className:"tiny-code",editable:!1,basicSetup:!1,extensions:R,value:r}),e[2]=r,e[3]=l,e[4]=t):t=e[4];let n;return e[5]!==o||e[6]!==t?(n=(0,h.jsx)("div",{className:o,children:t}),e[5]=o,e[6]=t,e[7]=n):n=e[7],n});B.displayName="TinyCode";var N=p(E());const W=i=>{let e=(0,N.c)(16),r,a,s,o,l;e[0]===i?(r=e[1],a=e[2],s=e[3],o=e[4],l=e[5]):({value:l,onChange:r,placeholder:s,onEnterKey:a,...o}=i,e[0]=i,e[1]=r,e[2]=a,e[3]=s,e[4]=o,e[5]=l);let t=(0,g.useRef)(null),n=S(l,r),u;e[6]===n.onBlur?u=e[7]:(u=()=>{let c=n.onBlur,d=t.current;if(d)return d.addEventListener("blur",c),()=>{d.removeEventListener("blur",c)}},e[6]=n.onBlur,e[7]=u),I(u);let v=n.value,y=n.onChange,f;e[8]===a?f=e[9]:(f=b.onEnter(c=>{b.stopPropagation()(c),a==null||a()}),e[8]=a,e[9]=f);let m;return e[10]!==n.onChange||e[11]!==n.value||e[12]!==s||e[13]!==o||e[14]!==f?(m=(0,h.jsx)(_,{"data-testid":"cell-name-input",value:v,onChange:y,ref:t,placeholder:s,className:"shadow-none! hover:shadow-none focus:shadow-none focus-visible:shadow-none",onKeyDown:f,...o}),e[10]=n.onChange,e[11]=n.value,e[12]=s,e[13]=o,e[14]=f,e[15]=m):m=e[15],m},q=i=>{let e=(0,N.c)(13),{value:r,cellId:a,className:s}=i,{updateCellName:o}=L(),l;e[0]!==a||e[1]!==o?(l=d=>o({cellId:a,name:d}),e[0]=a,e[1]=o,e[2]=l):l=e[2];let t=S(r,l);if(C(r))return null;let n=t.focusing?"":"text-ellipsis",u;e[3]!==s||e[4]!==n?(u=w("outline-hidden border hover:border-cyan-500/40 focus:border-cyan-500/40",n,s),e[3]=s,e[4]=n,e[5]=u):u=e[5];let v=t.onChange,y=t.onBlur,f=t.onFocus,m;e[6]===Symbol.for("react.memo_cache_sentinel")?(m=b.onEnter(G),e[6]=m):m=e[6];let c;return e[7]!==t.onBlur||e[8]!==t.onChange||e[9]!==t.onFocus||e[10]!==u||e[11]!==r?(c=(0,h.jsx)(D,{content:"Click to rename",children:(0,h.jsx)("span",{className:u,contentEditable:!0,suppressContentEditableWarning:!0,onChange:v,onBlur:y,onFocus:f,onKeyDown:m,children:r})}),e[7]=t.onBlur,e[8]=t.onChange,e[9]=t.onFocus,e[10]=u,e[11]=r,e[12]=c):c=e[12],c};function S(i,e){let[r,a]=(0,g.useState)(i),[s,o]=(0,g.useState)(!1),l=t=>{if(t===i)return;if(!t||C(t)){e(t);return}let n=T(t,j());e(n)};return{value:C(r)?"":r,focusing:s,onChange:t=>{let n=t.target.value,u=x(n);a(u)},onBlur:t=>{if(t.target instanceof HTMLInputElement){let n=t.target.value;l(x(n))}else if(t.target instanceof HTMLSpanElement){let n=t.target.innerText.trim();l(x(n)),t.target.scrollLeft=0,o(!1)}},onFocus:()=>{o(!0)}}}function G(i){i.target instanceof HTMLElement&&i.target.blur()}export{O as i,W as n,B as r,q as t};
