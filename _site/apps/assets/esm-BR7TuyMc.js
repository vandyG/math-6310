import{s as V}from"./chunk-DZLz74EQ.js";import{t as ut}from"./react-BcIddLXZ.js";import{t as dt}from"./jsx-runtime-DvsdsEjx.js";import{E as mt,Ft as F,Ht as ft,M as pt,P as gt,R as G,St as bt,U as e,_ as q,_t as P,a as vt,ct as St,et as b,ht as Q,kt,m as yt,mt as Ct,ot as xt,pt as wt,st as X,w as Et,xt as Mt,yt as Tt}from"./dist-CoL9j4yJ.js";import{C as Wt,_ as Y,c as Lt,g as Z,l as Ht,r as Nt,y as $}from"./dist-Cs8TISgf.js";import{a as Bt,c as Ot,i as Kt,r as Dt}from"./dist-DIuPmJ5w.js";import{t as zt}from"./extends--r5KbeWh.js";import{t as At}from"./objectWithoutPropertiesLoose-CGYpiDu4.js";var tt=function(t){t===void 0&&(t={});var{crosshairCursor:i=!1}=t,a=[];t.closeBracketsKeymap!==!1&&(a=a.concat(Bt)),t.defaultKeymap!==!1&&(a=a.concat(Z)),t.searchKeymap!==!1&&(a=a.concat(Ht)),t.historyKeymap!==!1&&(a=a.concat($)),t.foldKeymap!==!1&&(a=a.concat(mt)),t.completionKeymap!==!1&&(a=a.concat(Ot)),t.lintKeymap!==!1&&(a=a.concat(Nt));var o=[];return t.lineNumbers!==!1&&o.push(Tt()),t.highlightActiveLineGutter!==!1&&o.push(Ct()),t.highlightSpecialChars!==!1&&o.push(Q()),t.history!==!1&&o.push(Y()),t.foldGutter!==!1&&o.push(Et()),t.drawSelection!==!1&&o.push(X()),t.dropCursor!==!1&&o.push(St()),t.allowMultipleSelections!==!1&&o.push(F.allowMultipleSelections.of(!0)),t.indentOnInput!==!1&&o.push(pt()),t.syntaxHighlighting!==!1&&o.push(G(q,{fallback:!0})),t.bracketMatching!==!1&&o.push(yt()),t.closeBrackets!==!1&&o.push(Kt()),t.autocompletion!==!1&&o.push(Dt()),t.rectangularSelection!==!1&&o.push(bt()),i!==!1&&o.push(xt()),t.highlightActiveLine!==!1&&o.push(wt()),t.highlightSelectionMatches!==!1&&o.push(Lt()),t.tabSize&&typeof t.tabSize=="number"&&o.push(gt.of(" ".repeat(t.tabSize))),o.concat([P.of(a.flat())]).filter(Boolean)},Ft=function(t){t===void 0&&(t={});var i=[];t.defaultKeymap!==!1&&(i=i.concat(Z)),t.historyKeymap!==!1&&(i=i.concat($));var a=[];return t.highlightSpecialChars!==!1&&a.push(Q()),t.history!==!1&&a.push(Y()),t.drawSelection!==!1&&a.push(X()),t.syntaxHighlighting!==!1&&a.push(G(q,{fallback:!0})),a.concat([P.of(i.flat())]).filter(Boolean)},It="#e5c07b",et="#e06c75",_t="#56b6c2",Ut="#ffffff",I="#abb2bf",R="#7d8799",jt="#61afef",Gt="#98c379",at="#d19a66",Pt="#c678dd",Rt="#21252b",ot="#2c313a",it="#282c34",J="#353a42",Jt="#3E4451",rt="#528bff",Vt=b.theme({"&":{color:I,backgroundColor:it},".cm-content":{caretColor:rt},".cm-cursor, .cm-dropCursor":{borderLeftColor:rt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Jt},".cm-panels":{backgroundColor:Rt,color:I},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:it,color:R,border:"none"},".cm-activeLineGutter":{backgroundColor:ot},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:J},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:J,borderBottomColor:J},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:ot,color:I}}},{dark:!0}),qt=vt.define([{tag:e.keyword,color:Pt},{tag:[e.name,e.deleted,e.character,e.propertyName,e.macroName],color:et},{tag:[e.function(e.variableName),e.labelName],color:jt},{tag:[e.color,e.constant(e.name),e.standard(e.name)],color:at},{tag:[e.definition(e.name),e.separator],color:I},{tag:[e.typeName,e.className,e.number,e.changed,e.annotation,e.modifier,e.self,e.namespace],color:It},{tag:[e.operator,e.operatorKeyword,e.url,e.escape,e.regexp,e.link,e.special(e.string)],color:_t},{tag:[e.meta,e.comment],color:R},{tag:e.strong,fontWeight:"bold"},{tag:e.emphasis,fontStyle:"italic"},{tag:e.strikethrough,textDecoration:"line-through"},{tag:e.link,color:R,textDecoration:"underline"},{tag:e.heading,fontWeight:"bold",color:et},{tag:[e.atom,e.bool,e.special(e.variableName)],color:at},{tag:[e.processingInstruction,e.string,e.inserted],color:Gt},{tag:e.invalid,color:Ut}]),Qt=[Vt,G(qt)],Xt=b.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),nt=function(t){t===void 0&&(t={});var{indentWithTab:i=!0,editable:a=!0,readOnly:o=!1,theme:m="light",placeholder:f="",basicSetup:l=!0}=t,n=[];switch(i&&n.unshift(P.of([Wt])),l&&(typeof l=="boolean"?n.unshift(tt()):n.unshift(tt(l))),f&&n.unshift(Mt(f)),m){case"light":n.push(Xt);break;case"dark":n.push(Qt);break;case"none":break;default:n.push(m);break}return a===!1&&n.push(b.editable.of(!1)),o&&n.push(F.readOnly.of(!0)),[...n]},Yt=t=>({line:t.state.doc.lineAt(t.state.selection.main.from),lineCount:t.state.doc.lines,lineBreak:t.state.lineBreak,length:t.state.doc.length,readOnly:t.state.readOnly,tabSize:t.state.tabSize,selection:t.state.selection,selectionAsSingle:t.state.selection.asSingle().main,ranges:t.state.selection.ranges,selectionCode:t.state.sliceDoc(t.state.selection.main.from,t.state.selection.main.to),selections:t.state.selection.ranges.map(i=>t.state.sliceDoc(i.from,i.to)),selectedText:t.state.selection.ranges.some(i=>!i.empty)}),Zt=class{constructor(t,i){this.timeLeftMS=void 0,this.timeoutMS=void 0,this.isCancelled=!1,this.isTimeExhausted=!1,this.callbacks=[],this.timeLeftMS=i,this.timeoutMS=i,this.callbacks.push(t)}tick(){if(!this.isCancelled&&!this.isTimeExhausted&&(this.timeLeftMS--,this.timeLeftMS<=0)){this.isTimeExhausted=!0;var t=this.callbacks.slice();this.callbacks.length=0,t.forEach(i=>{try{i()}catch(a){console.error("TimeoutLatch callback error:",a)}})}}cancel(){this.isCancelled=!0,this.callbacks.length=0}reset(){this.timeLeftMS=this.timeoutMS,this.isCancelled=!1,this.isTimeExhausted=!1}get isDone(){return this.isCancelled||this.isTimeExhausted}},st=class{constructor(){this.interval=null,this.latches=new Set}add(t){this.latches.add(t),this.start()}remove(t){this.latches.delete(t),this.latches.size===0&&this.stop()}start(){this.interval===null&&(this.interval=setInterval(()=>{this.latches.forEach(t=>{t.tick(),t.isDone&&this.remove(t)})},1))}stop(){this.interval!==null&&(clearInterval(this.interval),this.interval=null)}},ct=null,$t=()=>typeof window>"u"?new st:(ct||(ct=new st),ct),s=V(ut()),lt=kt.define(),te=200,ee=[];function ae(t){var{value:i,selection:a,onChange:o,onStatistics:m,onCreateEditor:f,onUpdate:l,extensions:n=ee,autoFocus:w,theme:E="light",height:M=null,minHeight:v=null,maxHeight:T=null,width:W=null,minWidth:L=null,maxWidth:H=null,placeholder:N="",editable:B=!0,readOnly:O=!1,indentWithTab:K=!0,basicSetup:D=!0,root:_,initialState:C}=t,[S,z]=(0,s.useState)(),[r,d]=(0,s.useState)(),[k,y]=(0,s.useState)(),c=(0,s.useState)(()=>({current:null}))[0],p=(0,s.useState)(()=>({current:null}))[0],U=b.theme({"&":{height:M,minHeight:v,maxHeight:T,width:W,minWidth:L,maxWidth:H},"& .cm-scroller":{height:"100% !important"}}),j=b.updateListener.of(h=>{if(h.docChanged&&typeof o=="function"&&!h.transactions.some(u=>u.annotation(lt))){c.current?c.current.reset():(c.current=new Zt(()=>{if(p.current){var u=p.current;p.current=null,u()}c.current=null},te),$t().add(c.current));var g=h.state.doc.toString();o(g,h)}m&&m(Yt(h))}),A=nt({theme:E,editable:B,readOnly:O,placeholder:N,indentWithTab:K,basicSetup:D}),x=[j,U,...A];return l&&typeof l=="function"&&x.push(b.updateListener.of(l)),x=x.concat(n),(0,s.useLayoutEffect)(()=>{if(S&&!k){var h={doc:i,selection:a,extensions:x},g=C?F.fromJSON(C.json,h,C.fields):F.create(h);if(y(g),!r){var u=new b({state:g,parent:S,root:_});d(u),f&&f(u,g)}}return()=>{r&&(y(void 0),d(void 0))}},[S,k]),(0,s.useEffect)(()=>{t.container&&z(t.container)},[t.container]),(0,s.useEffect)(()=>()=>{r&&(r.destroy(),d(void 0)),c.current&&(c.current=(c.current.cancel(),null))},[r]),(0,s.useEffect)(()=>{w&&r&&r.focus()},[w,r]),(0,s.useEffect)(()=>{r&&r.dispatch({effects:ft.reconfigure.of(x)})},[E,n,M,v,T,W,L,H,N,B,O,K,D,o,l]),(0,s.useEffect)(()=>{if(i!==void 0){var h=r?r.state.doc.toString():"";if(r&&i!==h){var g=c.current&&!c.current.isDone,u=()=>{r&&i!==r.state.doc.toString()&&r.dispatch({changes:{from:0,to:r.state.doc.toString().length,insert:i||""},annotations:[lt.of(!0)]})};g?p.current=u:u()}}},[i,r]),{state:k,setState:y,view:r,setView:d,container:S,setContainer:z}}var oe=V(dt()),ie=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],ht=(0,s.forwardRef)((t,i)=>{var{className:a,value:o="",selection:m,extensions:f=[],onChange:l,onStatistics:n,onCreateEditor:w,onUpdate:E,autoFocus:M,theme:v="light",height:T,minHeight:W,maxHeight:L,width:H,minWidth:N,maxWidth:B,basicSetup:O,placeholder:K,indentWithTab:D,editable:_,readOnly:C,root:S,initialState:z}=t,r=At(t,ie),d=(0,s.useRef)(null),{state:k,view:y,container:c,setContainer:p}=ae({root:S,value:o,autoFocus:M,theme:v,height:T,minHeight:W,maxHeight:L,width:H,minWidth:N,maxWidth:B,basicSetup:O,placeholder:K,indentWithTab:D,editable:_,readOnly:C,selection:m,onChange:l,onStatistics:n,onCreateEditor:w,onUpdate:E,extensions:f,initialState:z});(0,s.useImperativeHandle)(i,()=>({editor:d.current,state:k,view:y}),[d,c,k,y]);var U=(0,s.useCallback)(A=>{d.current=A,p(A)},[p]);if(typeof o!="string")throw Error("value must be typeof string but got "+typeof o);var j=typeof v=="string"?"cm-theme-"+v:"cm-theme";return(0,oe.jsx)("div",zt({ref:U,className:""+j+(a?" "+a:"")},r))});ht.displayName="CodeMirror";var re=ht;export{nt as n,Ft as r,re as t};
